{% extends "base.html" %}

{% block body_class %}hide-top-bar{% endblock %}
{% load widget_tweaks %}

{% block content %}
<div class="container py-4">
	<div class="row justify-content-center">
		<div class="col-md-8">
			<div class="card">
				<div class="card-header">
					<h4 class="m-0">
						{% if sucursal %}
							Editar Sucursal: {{ sucursal.nombre }}
						{% else %}
							Nueva Sucursal
						{% endif %}
						{% if empresa %}
							- {{ empresa.nombre }}
						{% endif %}
					</h4>
				</div>
				<div class="card-body">
					<form method="post">
						{% csrf_token %}
						
						<div class="row">
							<div class="col-md-6 mb-3">
								<label class="form-label">Nombre de la Sucursal *</label>
								<input type="text" name="nombre" class="form-control" value="{{ sucursal.nombre|default:'' }}" required>
							</div>
							<div class="col-md-6 mb-3">
								<label class="form-label">Código de Sucursal *</label>
								<input type="text" name="codigo" class="form-control" value="{{ sucursal.codigo|default:'' }}" required>
							</div>
						</div>
						
						<div class="mb-3">
							<label class="form-label">Dirección *</label>
							<textarea name="direccion" class="form-control" rows="2" required>{{ sucursal.direccion|default:'' }}</textarea>
						</div>
						
						<div class="row">
							<div class="col-md-4 mb-3">
								<label class="form-label">Comuna *</label>
								<input type="text" name="comuna" class="form-control" value="{{ sucursal.comuna|default:'' }}" required>
							</div>
							<div class="col-md-4 mb-3">
								<label class="form-label">Ciudad *</label>
								<input type="text" name="ciudad" class="form-control" value="{{ sucursal.ciudad|default:'' }}" required>
							</div>
							<div class="col-md-4 mb-3">
								<label class="form-label">Región *</label>
								<input type="text" name="region" class="form-control" value="{{ sucursal.region|default:'' }}" required>
							</div>
						</div>
						
						<div class="row">
							<div class="col-md-6 mb-3">
								<label class="form-label">Teléfono *</label>
								<input type="tel" name="telefono" class="form-control" value="{{ sucursal.telefono|default:'' }}" required>
							</div>
							<div class="col-md-6 mb-3">
								<label class="form-label">Email</label>
								<input type="email" name="email" class="form-control" value="{{ sucursal.email|default:'' }}">
							</div>
						</div>
						
						<div class="row">
							<div class="col-md-6 mb-3">
								<label class="form-label">Hora de Apertura *</label>
								<input type="time" name="horario_apertura" class="form-control" value="{{ sucursal.horario_apertura|time:'H:i'|default:'08:00' }}" required>
							</div>
							<div class="col-md-6 mb-3">
								<label class="form-label">Hora de Cierre *</label>
								<input type="time" name="horario_cierre" class="form-control" value="{{ sucursal.horario_cierre|time:'H:i'|default:'18:00' }}" required>
							</div>
						</div>
						
						<div class="row">
							<div class="col-md-6 mb-3">
								<label class="form-label">Estado *</label>
								<select name="estado" class="form-select" required>
									<option value="">Seleccione...</option>
									<option value="activa" {% if sucursal.estado == 'activa' %}selected{% endif %}>Activa</option>
									<option value="inactiva" {% if sucursal.estado == 'inactiva' %}selected{% endif %}>Inactiva</option>
									<option value="en_construccion" {% if sucursal.estado == 'en_construccion' %}selected{% endif %}>En Construcción</option>
								</select>
							</div>
							<div class="col-md-6 mb-3">
								<div class="form-check mt-4">
									<input type="checkbox" name="es_principal" class="form-check-input" id="es_principal" {% if sucursal.es_principal %}checked{% endif %}>
									<label class="form-check-label" for="es_principal">
										Es Sucursal Principal
									</label>
								</div>
							</div>
						</div>
						
						<div class="d-flex justify-content-between">
							<a href="{% if sucursal %}{% url 'empresas:sucursal_detail' sucursal.id %}{% elif empresa %}{% url 'empresas:sucursal_list' empresa.id %}{% else %}{% url 'empresas:home' %}{% endif %}" class="btn btn-outline-dark">
								Cancelar
							<button type="submit" class="btn btn-dark">
								{% if sucursal %}Actualizar{% else %}Crear{% endif %} Sucursal
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

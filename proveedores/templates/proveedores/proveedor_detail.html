{% extends "base.html" %}
{% load static %}

{% block title %}Detalle del Proveedor{% endblock %}

{% block body_class %}hide-top-bar{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card shadow-lg" style="border: none; border-radius: 15px; overflow: hidden;">
                <!-- Header -->
                <div class="card-header" style="background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%); color: white; padding: 15px 20px; font-family: 'Poppins', sans-serif;">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-truck me-3" style="font-size: 1.8rem; color: #F4E4BC;"></i>
                                <div>
                                    <h4 class="mb-1" style="font-weight: 600; font-size: 1.4rem; font-family: 'Poppins', sans-serif;">{{ proveedor.nombre }}</h4>
                                    <small style="font-size: 0.9rem; opacity: 0.9; font-family: 'Poppins', sans-serif;">{{ proveedor.get_rut_formateado }} - {{ proveedor.get_tipo_proveedor_display }}</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <a href="{% url 'proveedores:proveedor_list' %}" class="btn btn-light btn-sm me-2" style="font-family: 'Poppins', sans-serif;">
                                <i class="fas fa-arrow-left me-2"></i>Volver
                            </a>
                            <a href="{% url 'proveedores:proveedor_update' proveedor.pk %}" class="btn btn-warning btn-sm" style="font-family: 'Poppins', sans-serif;">
                                <i class="fas fa-edit me-2"></i>Editar
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Contenido con pestañas -->
                <div class="card-body p-0">
                    <!-- Pestañas -->
                    <ul class="nav nav-tabs" id="proveedorDetailTabs" role="tablist" style="border-bottom: 2px solid #e9ecef; margin: 0; font-family: 'Poppins', sans-serif;">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="info-general-tab" data-bs-toggle="tab" data-bs-target="#info-general" type="button" role="tab"
                                    style="border: none; border-radius: 0; padding: 12px 20px; font-weight: 500; color: #495057; background: transparent; font-family: 'Poppins', sans-serif;">
                                <i class="fas fa-info-circle me-2"></i>Información General
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="datos-comerciales-tab" data-bs-toggle="tab" data-bs-target="#datos-comerciales" type="button" role="tab"
                                    style="border: none; border-radius: 0; padding: 12px 20px; font-weight: 500; color: #495057; background: transparent; font-family: 'Poppins', sans-serif;">
                                <i class="fas fa-chart-line me-2"></i>Datos Comerciales
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="contactos-tab" data-bs-toggle="tab" data-bs-target="#contactos" type="button" role="tab"
                                    style="border: none; border-radius: 0; padding: 12px 20px; font-weight: 500; color: #495057; background: transparent; font-family: 'Poppins', sans-serif;">
                                <i class="fas fa-address-book me-2"></i>Contactos ({{ contactos.count }})
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="evaluaciones-tab" data-bs-toggle="tab" data-bs-target="#evaluaciones" type="button" role="tab"
                                    style="border: none; border-radius: 0; padding: 12px 20px; font-weight: 500; color: #495057; background: transparent; font-family: 'Poppins', sans-serif;">
                                <i class="fas fa-star me-2"></i>Evaluaciones
                            </button>
                        </li>
                    </ul>

                    <!-- Contenido de las pestañas -->
                    <div class="tab-content" id="proveedorDetailTabsContent" style="padding: 20px; font-family: 'Poppins', sans-serif;">
                        <!-- Pestaña 1: Información General -->
                        <div class="tab-pane fade show active" id="info-general" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5 class="mb-4" style="color: #2c3e50; font-weight: 600; border-bottom: 2px solid #8B4513; padding-bottom: 10px;">
                                        <i class="fas fa-truck me-2" style="color: #8B4513;"></i>Datos del Proveedor
                                    </h5>
                                    
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Nombre:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.nombre }}</div>
                                    </div>
                                    
                                    {% if proveedor.razon_social %}
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Razón Social:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.razon_social }}</div>
                                    </div>
                                    {% endif %}
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>RUT:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.get_rut_formateado }}</div>
                                    </div>
                                    
                                    {% if proveedor.giro %}
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Giro:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.giro }}</div>
                                    </div>
                                    {% endif %}
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Tipo:</strong></div>
                                        <div class="col-sm-8">
                                            <span class="badge" style="background-color: #e3f2fd; color: #1976d2;">
                                                {{ proveedor.get_tipo_proveedor_display }}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    {% if proveedor.categoria_principal %}
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Categoría Principal:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.categoria_principal }}</div>
                                    </div>
                                    {% endif %}
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Estado:</strong></div>
                                        <div class="col-sm-8">
                                            <span class="badge badge-{{ proveedor.get_estado_display_color }}">
                                                {{ proveedor.get_estado_display }}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Fecha de Alta:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.fecha_alta|date:"d/m/Y" }}</div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <h5 class="mb-4" style="color: #2c3e50; font-weight: 600; border-bottom: 2px solid #8B4513; padding-bottom: 10px;">
                                        <i class="fas fa-map-marker-alt me-2" style="color: #8B4513;"></i>Información de Contacto
                                    </h5>
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Dirección:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.direccion }}</div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Comuna:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.comuna }}</div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Ciudad:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.ciudad }}</div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Región:</strong></div>
                                        <div class="col-sm-8">{{ proveedor.region }}</div>
                                    </div>
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Teléfono:</strong></div>
                                        <div class="col-sm-8">
                                            <i class="fas fa-phone me-2" style="color: #8B4513;"></i>{{ proveedor.telefono }}
                                        </div>
                                    </div>
                                    
                                    {% if proveedor.email %}
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Email:</strong></div>
                                        <div class="col-sm-8">
                                            <i class="fas fa-envelope me-2" style="color: #8B4513;"></i>
                                            <a href="mailto:{{ proveedor.email }}" style="color: #8B4513;">{{ proveedor.email }}</a>
                                        </div>
                                    </div>
                                    {% endif %}
                                    
                                    {% if proveedor.sitio_web %}
                                    <div class="row mb-3">
                                        <div class="col-sm-4"><strong>Sitio Web:</strong></div>
                                        <div class="col-sm-8">
                                            <i class="fas fa-globe me-2" style="color: #8B4513;"></i>
                                            <a href="{{ proveedor.get_sitio_web_formateado }}" target="_blank" style="color: #8B4513;">{{ proveedor.sitio_web }}</a>
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            {% if proveedor.observaciones %}
                            <div class="row mt-4">
                                <div class="col-12">
                                    <h5 style="color: #2c3e50; font-weight: 600; border-bottom: 2px solid #8B4513; padding-bottom: 10px;">
                                        <i class="fas fa-sticky-note me-2" style="color: #8B4513;"></i>Observaciones Generales
                                    </h5>
                                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #8B4513;">
                                        {{ proveedor.observaciones|linebreaks }}
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        
                        <!-- Pestaña 2: Datos Comerciales -->
                        <div class="tab-pane fade" id="datos-comerciales" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5 class="mb-4" style="color: #2c3e50; font-weight: 600; border-bottom: 2px solid #8B4513; padding-bottom: 10px;">
                                        <i class="fas fa-chart-line me-2" style="color: #8B4513;"></i>Condiciones Comerciales
                                    </h5>
                                    
                                    {% if proveedor.plazo_entrega %}
                                    <div class="row mb-3">
                                        <div class="col-sm-5"><strong>Plazo de Entrega:</strong></div>
                                        <div class="col-sm-7">
                                            <i class="fas fa-clock me-2" style="color: #8B4513;"></i>{{ proveedor.plazo_entrega }}
                                        </div>
                                    </div>
                                    {% endif %}
                                    
                                    {% if proveedor.condiciones_pago %}
                                    <div class="row mb-3">
                                        <div class="col-sm-5"><strong>Condiciones de Pago:</strong></div>
                                        <div class="col-sm-7">
                                            <i class="fas fa-credit-card me-2" style="color: #8B4513;"></i>{{ proveedor.condiciones_pago }}
                                        </div>
                                    </div>
                                    {% endif %}
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-5"><strong>Descuento por Defecto:</strong></div>
                                        <div class="col-sm-7">
                                            <i class="fas fa-percentage me-2" style="color: #8B4513;"></i>{{ proveedor.descuento_porcentaje }}%
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <h5 class="mb-4" style="color: #2c3e50; font-weight: 600; border-bottom: 2px solid #8B4513; padding-bottom: 10px;">
                                        <i class="fas fa-star me-2" style="color: #8B4513;"></i>Calificación
                                    </h5>
                                    
                                    <div class="row mb-3">
                                        <div class="col-sm-5"><strong>Calificación:</strong></div>
                                        <div class="col-sm-7">
                                            <div class="d-flex align-items-center">
                                                <span class="me-2" style="color: #ffc107; font-size: 1.2rem;">{{ proveedor.get_calificacion_estrellas }}</span>
                                                <span style="font-weight: 600;">{{ proveedor.calificacion }}/5</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {% if proveedor.observaciones_calidad %}
                                    <div class="row mb-3">
                                        <div class="col-sm-5"><strong>Observaciones de Calidad:</strong></div>
                                        <div class="col-sm-7">{{ proveedor.observaciones_calidad|linebreaks }}</div>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <!-- Categorías del proveedor -->
                            {% if categorias %}
                            <div class="row mt-4">
                                <div class="col-12">
                                    <h5 style="color: #2c3e50; font-weight: 600; border-bottom: 2px solid #8B4513; padding-bottom: 10px;">
                                        <i class="fas fa-folder me-2" style="color: #8B4513;"></i>Categorías
                                    </h5>
                                    <div class="row">
                                        {% for categoria in categorias %}
                                        <div class="col-md-6 mb-3">
                                            <div class="card" style="border: 2px solid #e9ecef; border-radius: 8px;">
                                                <div class="card-body" style="padding: 15px;">
                                                    <div class="d-flex justify-content-between align-items-start">
                                                        <div>
                                                            <h6 class="mb-1" style="font-weight: 600;">
                                                                {% if categoria.es_categoria_principal %}
                                                                    <i class="fas fa-star text-warning me-2"></i>
                                                                {% endif %}
                                                                Categoría
                                                            </h6>
                                                            {% if categoria.descripcion %}
                                                                <p class="mb-2 text-muted" style="font-size: 0.9rem;">{{ categoria.descripcion }}</p>
                                                            {% endif %}
                                                            <div class="d-flex justify-content-between">
                                                                <small class="text-muted">
                                                                    <i class="fas fa-percentage me-1"></i>
                                                                    Descuento: {{ categoria.descuento_categoria }}%
                                                                </small>
                                                                <span class="badge {% if categoria.activa %}badge-success{% else %}badge-secondary{% endif %}">
                                                                    {% if categoria.activa %}Activa{% else %}Inactiva{% endif %}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        
                        <!-- Pestaña 3: Contactos -->
                        <div class="tab-pane fade" id="contactos" role="tabpanel">
                            <div class="row mb-4">
                                <div class="col-12">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h5 style="color: #2c3e50; font-weight: 600; border-bottom: 2px solid #8B4513; padding-bottom: 10px; margin-bottom: 0;">
                                            <i class="fas fa-address-book me-2" style="color: #8B4513;"></i>Contactos del Proveedor
                                        </h5>
                                        <button type="button" class="btn btn-sm" style="background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%); border: none; color: white; border-radius: 6px; font-family: 'Poppins', sans-serif;" data-bs-toggle="modal" data-bs-target="#contactoModal">
                                            <i class="fas fa-plus me-2"></i>Agregar Contacto
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            {% if contactos %}
                                <div class="row">
                                    {% for contacto in contactos %}
                                    <div class="col-md-6 mb-4">
                                        <div class="card" style="border: 2px solid #e9ecef; border-radius: 10px; transition: all 0.3s ease;" onmouseover="this.style.borderColor='#8B4513'" onmouseout="this.style.borderColor='#e9ecef'">
                                            <div class="card-header" style="background: {% if contacto.es_contacto_principal %}linear-gradient(135deg, #ffc107 0%, #ffb347 100%){% else %}linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%){% endif %}; border: none; padding: 15px;">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h6 class="mb-0" style="font-weight: 600; color: {% if contacto.es_contacto_principal %}#212529{% else %}#495057{% endif %}; font-family: 'Poppins', sans-serif;">
                                                        {% if contacto.es_contacto_principal %}
                                                            <i class="fas fa-star text-warning me-2"></i>
                                                        {% endif %}
                                                        {{ contacto.nombre }}
                                                    </h6>
                                                    <div class="btn-group btn-group-sm">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="editarContacto({{ contacto.id }})" style="border-radius: 4px;">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" onclick="eliminarContacto({{ contacto.id }})" style="border-radius: 4px;">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body" style="padding: 15px;">
                                                {% if contacto.cargo %}
                                                <div class="mb-2">
                                                    <strong><i class="fas fa-briefcase me-2" style="color: #8B4513;"></i>Cargo:</strong>
                                                    <span class="text-muted">{{ contacto.cargo }}</span>
                                                </div>
                                                {% endif %}
                                                
                                                <div class="mb-2">
                                                    <strong><i class="fas fa-tags me-2" style="color: #8B4513;"></i>Tipo:</strong>
                                                    <span class="badge" style="background-color: #e3f2fd; color: #1976d2;">{{ contacto.get_tipo_contacto_display }}</span>
                                                </div>
                                                
                                                {% if contacto.telefono %}
                                                <div class="mb-2">
                                                    <strong><i class="fas fa-phone me-2" style="color: #8B4513;"></i>Teléfono:</strong>
                                                    <span class="text-muted">{{ contacto.telefono }}</span>
                                                </div>
                                                {% endif %}
                                                
                                                {% if contacto.celular %}
                                                <div class="mb-2">
                                                    <strong><i class="fas fa-mobile-alt me-2" style="color: #8B4513;"></i>Celular:</strong>
                                                    <span class="text-muted">{{ contacto.celular }}</span>
                                                </div>
                                                {% endif %}
                                                
                                                {% if contacto.email %}
                                                <div class="mb-2">
                                                    <strong><i class="fas fa-envelope me-2" style="color: #8B4513;"></i>Email:</strong>
                                                    <a href="mailto:{{ contacto.email }}" style="color: #8B4513;">{{ contacto.email }}</a>
                                                </div>
                                                {% endif %}
                                                
                                                {% if contacto.observaciones %}
                                                <div class="mt-3">
                                                    <strong><i class="fas fa-sticky-note me-2" style="color: #8B4513;"></i>Observaciones:</strong>
                                                    <p class="text-muted mb-0" style="font-size: 0.9rem;">{{ contacto.observaciones }}</p>
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="text-center py-5">
                                    <i class="fas fa-address-book fa-3x text-muted mb-3" style="opacity: 0.5;"></i>
                                    <h5 class="text-muted" style="font-family: 'Poppins', sans-serif;">No hay contactos registrados</h5>
                                    <p class="text-muted" style="font-family: 'Poppins', sans-serif;">Agrega contactos para facilitar la comunicación con este proveedor.</p>
                                    <button type="button" class="btn" style="background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%); border: none; color: white; border-radius: 8px; font-family: 'Poppins', sans-serif;" data-bs-toggle="modal" data-bs-target="#contactoModal">
                                        <i class="fas fa-plus me-2"></i>Agregar Primer Contacto
                                    </button>
                                </div>
                            {% endif %}
                        </div>
                        
                        <!-- Pestaña 4: Evaluaciones -->
                        <div class="tab-pane fade" id="evaluaciones" role="tabpanel">
                            <div class="row mb-4">
                                <div class="col-12">
                                    <h5 style="color: #2c3e50; font-weight: 600; border-bottom: 2px solid #8B4513; padding-bottom: 10px; margin-bottom: 0;">
                                        <i class="fas fa-star me-2" style="color: #8B4513;"></i>Evaluaciones del Proveedor
                                    </h5>
                                </div>
                            </div>
                            
                            {% if evaluaciones %}
                                <div class="row">
                                    {% for evaluacion in evaluaciones %}
                                    <div class="col-12 mb-4">
                                        <div class="card" style="border: 2px solid #e9ecef; border-radius: 10px;">
                                            <div class="card-header" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border: none; padding: 15px;">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h6 class="mb-0" style="font-weight: 600; color: #495057; font-family: 'Poppins', sans-serif;">
                                                        {{ evaluacion.periodo_evaluado }}
                                                    </h6>
                                                    <div>
                                                        <span class="badge badge-{{ evaluacion.get_calificacion_general_color }} me-2">
                                                            {{ evaluacion.calificacion_general }}/5
                                                        </span>
                                                        <small class="text-muted">{{ evaluacion.fecha_evaluacion|date:"d/m/Y" }}</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body" style="padding: 20px;">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <h6 style="color: #495057; font-weight: 600;">Criterios de Evaluación:</h6>
                                                        <div class="mb-2">
                                                            <strong>Calidad de Productos:</strong>
                                                            <span class="badge badge-secondary ms-2">{{ evaluacion.calidad_productos }}/5</span>
                                                        </div>
                                                        <div class="mb-2">
                                                            <strong>Cumplimiento de Plazos:</strong>
                                                            <span class="badge badge-secondary ms-2">{{ evaluacion.cumplimiento_plazos }}/5</span>
                                                        </div>
                                                        <div class="mb-2">
                                                            <strong>Atención al Cliente:</strong>
                                                            <span class="badge badge-secondary ms-2">{{ evaluacion.atencion_cliente }}/5</span>
                                                        </div>
                                                        <div class="mb-2">
                                                            <strong>Precios Competitivos:</strong>
                                                            <span class="badge badge-secondary ms-2">{{ evaluacion.precios_competitivos }}/5</span>
                                                        </div>
                                                        <div class="mb-2">
                                                            <strong>Resolución de Problemas:</strong>
                                                            <span class="badge badge-secondary ms-2">{{ evaluacion.resolucion_problemas }}/5</span>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <h6 style="color: #495057; font-weight: 600;">Recomendación:</h6>
                                                        <span class="badge {% if evaluacion.recomendacion == 'mantener' %}badge-success{% elif evaluacion.recomendacion == 'mejorar' %}badge-warning{% elif evaluacion.recomendacion == 'revisar' %}badge-info{% else %}badge-danger{% endif %}">
                                                            {{ evaluacion.get_recomendacion_display }}
                                                        </span>
                                                        
                                                        {% if evaluacion.fortalezas %}
                                                        <div class="mt-3">
                                                            <strong>Fortalezas:</strong>
                                                            <p class="text-muted mb-0" style="font-size: 0.9rem;">{{ evaluacion.fortalezas }}</p>
                                                        </div>
                                                        {% endif %}
                                                        
                                                        {% if evaluacion.areas_mejora %}
                                                        <div class="mt-3">
                                                            <strong>Áreas de Mejora:</strong>
                                                            <p class="text-muted mb-0" style="font-size: 0.9rem;">{{ evaluacion.areas_mejora }}</p>
                                                        </div>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                                
                                                {% if evaluacion.comentarios_generales %}
                                                <div class="mt-3 pt-3" style="border-top: 1px solid #e9ecef;">
                                                    <strong>Comentarios Generales:</strong>
                                                    <p class="text-muted mb-0" style="font-size: 0.9rem;">{{ evaluacion.comentarios_generales }}</p>
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="text-center py-5">
                                    <i class="fas fa-star fa-3x text-muted mb-3" style="opacity: 0.5;"></i>
                                    <h5 class="text-muted" style="font-family: 'Poppins', sans-serif;">No hay evaluaciones registradas</h5>
                                    <p class="text-muted" style="font-family: 'Poppins', sans-serif;">Las evaluaciones ayudan a mantener un registro del rendimiento del proveedor.</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para contacto -->
<div class="modal fade" id="contactoModal" tabindex="-1" aria-labelledby="contactoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%); color: white;">
                <h5 class="modal-title" id="contactoModalLabel" style="font-family: 'Poppins', sans-serif;">
                    <i class="fas fa-user-plus me-2"></i>Agregar Contacto
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="contactoModalBody">
                <!-- El contenido se carga dinámicamente -->
            </div>
        </div>
    </div>
</div>

<style>
.badge-success {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%) !important;
    color: white !important;
}

.badge-warning {
    background: linear-gradient(135deg, #ffc107 0%, #ffb347 100%) !important;
    color: white !important;
}

.badge-danger {
    background: linear-gradient(135deg, #dc3545 0%, #ff6b6b 100%) !important;
    color: white !important;
}

.badge-secondary {
    background: linear-gradient(135deg, #6c757d 0%, #adb5bd 100%) !important;
    color: white !important;
}

.badge-info {
    background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%) !important;
    color: white !important;
}
</style>

<script>
function editarContacto(contactoId) {
    // Implementar edición de contacto
    window.location.href = "{% url 'proveedores:contacto_update' proveedor.pk 0 %}".replace('0', contactoId);
}

function eliminarContacto(contactoId) {
    if (confirm('¿Estás seguro de que quieres eliminar este contacto?')) {
        window.location.href = "{% url 'proveedores:contacto_delete' proveedor.pk 0 %}".replace('0', contactoId);
    }
}

// Modal para agregar contacto
document.getElementById('contactoModal').addEventListener('show.bs.modal', function () {
    const modalBody = document.getElementById('contactoModalBody');
    modalBody.innerHTML = '<div class="text-center"><div class="spinner-border" role="status"><span class="visually-hidden">Cargando...</span></div></div>';
    
    fetch("{% url 'proveedores:contacto_create' proveedor.pk %}")
        .then(response => response.text())
        .then(html => {
            modalBody.innerHTML = html;
        })
        .catch(error => {
            modalBody.innerHTML = '<div class="alert alert-danger">Error al cargar el formulario.</div>';
        });
});
</script>
{% endblock %}
